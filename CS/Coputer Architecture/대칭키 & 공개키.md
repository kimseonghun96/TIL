# 김성훈

## 대칭키 & 공개키

### HTTPS를 사용하는 이유

- HTTPS의 s는 secure이다. 즉, 기존의 HTTP 사이트보다 안전하다는 것
- 내가 어떤 웹사이트에 보내는 정보를 다른 누군가 훔쳐보지 못하게 한다. HTTPS는 이 정보를 **뒤죽박죽이 된 텍스트**로 변경하여 보낸다.
- 또한 사이트를 검증해준다. **기관으로 검증된 사이트만 주소에 HTTPS 사용이 허가**되고 그냥 HTTP만 사용하는 사이트에는 주소창에 ‘안전하지 않다.’라는 표시가 뜨게 된다.
- 요약
  1. 내가 사이트에 보내는 정보들을 제 3자가 못 보게 한다.
  2. 접속한 사이트가 믿을 만한 곳인지를 알려준다.

### **대칭키(Symmetric Key)**

> 암호화와 복호화에 같은 암호키(대칭키)를 사용하는 알고리즘

- 복호화 : 메세지를 보내는 쪽과 메세지를 받는 쪽이 메세지를 암호화하고, 이를 다시 메세지로 바꾸는 방법

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/508e4892-0806-4de8-bdcd-6846439ea664/efa3b5c0-5e83-4082-8286-3fbba8ecff28/Untitled.png)

장점: **동일한 키**를 주고받기 때문에, 매우 빠르다는 장점이 있음

단점: 대칭키 전달과정에서 해킹 위험에 노출될 가능성이 있다.

### **[#](https://gyoogle.dev/blog/computer-science/network/%EB%8C%80%EC%B9%AD%ED%82%A4%20&%20%EA%B3%B5%EA%B0%9C%ED%82%A4.html#%E1%84%80%E1%85%A9%E1%86%BC%E1%84%80%E1%85%A2%E1%84%8F%E1%85%B5-public-key-%E1%84%87%E1%85%B5%E1%84%83%E1%85%A2%E1%84%8E%E1%85%B5%E1%86%BC%E1%84%8F%E1%85%B5-asymmetric-key)공개키(Public Key)/비대칭키(Asymmetric Key)**

> 암호화와 복호화에 사용하는 암호키를 분리한 알고리즘

대칭키의 키 분배 문제를 해결하기 위해 고안됨.(대칭키일 때는 송수신자 간만 키를 알아야하기 때문에 분배가 복잡하고 어렵지만 공개키와 비밀키로 분리할 경우, 남들이 알아도 되는 공개키만 공개하면 되므로)

자신이 가지고 있는 고유한 암호키(비밀키)로만 복호화할 수 있는 암호키(공개키)를 대중에 공개함

→ 즉, 공개키를 알아 볼 수 있는 비밀키를 가지고 있으면 비밀키(개인키)를 가지고 있는 자만이 해석가능

### **[#](https://gyoogle.dev/blog/computer-science/network/%EB%8C%80%EC%B9%AD%ED%82%A4%20&%20%EA%B3%B5%EA%B0%9C%ED%82%A4.html#%E1%84%80%E1%85%A9%E1%86%BC%E1%84%80%E1%85%A2%E1%84%8F%E1%85%B5-%E1%84%8B%E1%85%A1%E1%86%B7%E1%84%92%E1%85%A9%E1%84%92%E1%85%AA-%E1%84%87%E1%85%A1%E1%86%BC%E1%84%89%E1%85%B5%E1%86%A8-%E1%84%8C%E1%85%B5%E1%86%AB%E1%84%92%E1%85%A2%E1%86%BC-%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A5%E1%86%BC)공개키 암호화 방식 진행 과정**

1. A가 웹 상에 공개된 'B의 공개키'를 이용해 평문을 암호화하여 B에게 보냄
2. B는 자신의 비밀키로 복호화한 평문을 확인, A의 공개키로 응답을 암호화하여 A에게 보냄
3. A는 자신의 비밀키로 암호화된 응답문을 복호화함

하지만 이 방식은 Confidentiallity(기밀성)만 보장해줄 뿐, Integrity(진실된 데이터)인지는 보장 못함.

또한 대칭키에 비해 암호화 복호화가 매우 복잡하다. (암호화하는 키가 복호화하는 키가 서로 다르기 때문)

### 그럼 공개키는 신뢰하는 방법? (진실된 데이터인지?)

신뢰할 수 있는 곳에서 공개키를 인증해준다.

공개키를 정품인지 확인 해주는 곳들이 있다.

Certificate Authority, 줄여서 CA라고 부른다.

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/508e4892-0806-4de8-bdcd-6846439ea664/2043352f-4c8c-4e5e-b0c2-6aca690a547c/Untitled.png)

브라우저 크롬, 사파리, 파이어 폭스와 같은 곳에서는 CA들이 내장 되어 있다.

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/508e4892-0806-4de8-bdcd-6846439ea664/a2b1a1ba-3fa5-4e9f-90c5-94319888f5e0/Untitled.png)

클라이언트는 서버를 신뢰하지 못해서 탐색과정을 거치는데 그것이 handshake라고 한다.

1. 클라이언트는 랜덤 데이터를 생성해서 서버에 보낸다. 서버도 답변으로 무작위 데이터를 보낼 때 해당서버의 인증서도 함께 실어보낸다.

2. 클라이언트는 이 인증서가 진짜인지 브라우저에 내장된 CA를 사용해 검증합니다. (비대칭키 시스템을 사용해서)

3. CA의 인증을 받은 인증서들은 해당 CA의 개인키로 암호화가 돼있다. 이게 진짜라면 브라우저에 저장된 그 CA의 공개키로 복호화할 수 있다. (이 공개키로 복호화 될 수 있는 인증서를 발급할 수 있는 건 그에 대응하는 개인키를 가진 CA일 뿐이다. 만약 이 CA 리스트 중에 인증서에 해당하는 것이 없다면, 브라우저에 신뢰할수 없는 사이트라는 알람이 뜬다.)

4. 성공적으로 복호화된 인증서에는 이 서버의 공개키가 포함되어 있다.

→ 이 공개키로 메시지들을 암호화해서 비대칭키 방식으로 주고받으면 되겠구나? → X

지금부터 주고 받아지는 데이터는 대칭키 방식과 비대칭키 방식이 함께 혼합되어서 사용된다.

대칭키를 사용하는 이유?

- 비대칭키 방식으로 메시지를 암호화 및 복호화하는 건 대칭키로 할 때보다 컴퓨터에 훨씬 큰 부담을 준다. 사이트를 이용할 때 주고받을 그 다량의 데이터를 비대칭키로 일일이 암호화, 복화하는 건 무리다.

- 그래서 위의 데이터는 대칭키로 암호화한다. → 대칭키는 탈취당할 수 있어서 위험하다?
  
  → 그 대칭키를 공유할 때 비대칭키를 사용한다. 처음에 주고받는 무작위의 데이터를 혼합하여 임시키를 만든다. 이 임시 키는 서버의 공개키로 암호화 돼서 서버로 보내진 다음 양쪽에서 일련의 과정을 거쳐서 동일한 대칭키가 만들어지는 것, 이 대칭키는 서버와 클라이언트 둘만 갖고 있으니까 이후 서로 주고받아지는 메시지들은 제 3자가 알아볼 수 없다.

### **[#](https://gyoogle.dev/blog/computer-science/network/%EB%8C%80%EC%B9%AD%ED%82%A4%20&%20%EA%B3%B5%EA%B0%9C%ED%82%A4.html#%E1%84%83%E1%85%A2%E1%84%8E%E1%85%B5%E1%86%BC%E1%84%8F%E1%85%B5%E1%84%8B%E1%85%AA-%E1%84%80%E1%85%A9%E1%86%BC%E1%84%80%E1%85%A2%E1%84%8F%E1%85%B5-%E1%84%8B%E1%85%A1%E1%86%B7%E1%84%92%E1%85%A9%E1%84%92%E1%85%AA-%E1%84%87%E1%85%A1%E1%86%BC%E1%84%89%E1%85%B5%E1%86%A8%E1%84%8B%E1%85%B3%E1%86%AF-%E1%84%8C%E1%85%A5%E1%86%A8%E1%84%8C%E1%85%A5%E1%86%AF%E1%84%92%E1%85%B5-%E1%84%92%E1%85%A9%E1%86%AB%E1%84%92%E1%85%A1%E1%86%B8%E1%84%92%E1%85%A2%E1%84%87%E1%85%A9%E1%84%86%E1%85%A7%E1%86%AB-%E1%84%92%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%87%E1%85%B3%E1%84%85%E1%85%B5%E1%84%83%E1%85%B3-%E1%84%87%E1%85%A1%E1%86%BC%E1%84%89%E1%85%B5%E1%86%A8)대칭키와 공개키 암호화 방식을 적절히 혼합해보면? (하이브리드 방식)**

> SSL 탄생의 시초가 됨

`1. A가 B의 공개키로 암호화 통신에 사용할 대칭키를 암호화하고 B에게 보냄 2. B는 암호문을 받고, 자신의 비밀키로 복호화함 3. B는 A로부터 얻은 대칭키로 A에게 보낼 평문을 암호화하여 A에게 보냄 4. A는 자신의 대칭키로 암호문을 복호화함 5. 앞으로 이 대칭키로 암호화를 통신함`

즉, 대칭키를 주고받을 때만 공개키 암호화 방식을 사용하고 이후에는 계속 대칭키 암호화 방식으로 통신하는 것!
